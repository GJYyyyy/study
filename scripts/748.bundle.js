"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[748],{4748:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});var i=function(){var t=this,e=t._self._c;return e("div",[e("van-form",{on:{submit:t.onSubmit}},[e("van-field",{attrs:{value:t.subjectList[t.subjectListIndex]?.title,readonly:"","is-link":"",label:"科目",placeholder:"请选择科目",rules:[{required:!0,message:"请选择科目"}]},on:{click:t.onSubjectPopupShow}}),t._v(" "),e("van-field",{attrs:{label:"父目录",readonly:"",value:t.parent?.title??"无"}}),t._v(" "),e("van-field",{attrs:{name:"目录名",label:"目录名",placeholder:"目录名",rules:[{required:!0,message:"请填写目录名"}]},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}}),t._v(" "),e("div",{staticStyle:{margin:"16px"}},[e("van-button",{attrs:{round:"",block:"",type:"info",size:"small","native-type":"submit"}},[t._v("提交")])],1)],1),t._v(" "),e("van-popup",{attrs:{position:"bottom"},model:{value:t.subjectPopupVisible,callback:function(e){t.subjectPopupVisible=e},expression:"subjectPopupVisible"}},[e("van-picker",{attrs:{title:"选择科目","show-toolbar":"","value-key":"title","default-index":t.subjectListIndex,columns:t.subjectList},on:{confirm:t.onSubjectConfirm,cancel:function(e){t.subjectPopupVisible=!1}}})],1)],1)};i._withStripped=!0;var a=s(2996),o=s(1241);const l="knowledge_catalog_id",n="subject_id",u="parent_id",r={data:()=>({formData:{title:"",[u]:"null",[n]:""},subjectPopupVisible:!1,subjectList:[],subjectListIndex:-1,parent:{}}),computed:{[n](){return this.$route.query.cate_id||this.$store.state.userInfo[n]},[u](){return this.$route.query.parent_id}},beforeMount(){let{formData:t}=this;t[n]=this[n],this.formData={...t}},async mounted(){let t=(await a.Z.listNoPageSubject({equalFields:{major_id:this.$store.state.subjectCate}})).list,e=t.findIndex((t=>t[n]===this[n]));this.subjectList=t,this.subjectListIndex=e;let s=await a.Z.detailKnowledgeCatalog(this.parent_id);if(s.data?.[l]){let{formData:t}=this;t.parent_id=s.data[l],this.formData={...t}}this.parent=s.data},methods:{onSubmit(){let t={...this.formData};t[n]=this.subjectList[this.subjectListIndex]?.[n],a.Z.addKnowledgeCatalog((0,o.mG)(t)).then((()=>{this.$toast.success({message:"添加成功",onClose:()=>this.$router.back()})}))},onSubjectPopupShow(){this[n]&&-1!==this.subjectListIndex?this.$toast({message:"已指定父级，不能修改"}):this.subjectPopupVisible=!0},onSubjectConfirm(t,e){this.subjectListIndex=e,this.subjectPopupVisible=!1}}},c=(0,s(1900).Z)(r,i,[],!1,null,null,null).exports}}]);