"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[696],{4696:(e,t,o)=>{o.r(t),o.d(t,{default:()=>s});var n=function(){var e=this,t=e._self._c;return t("div",[t("van-form",{on:{submit:e.submitForm}},[t("van-field",{attrs:{center:"",readonly:"","is-link":"",value:e.majorColumns[e.majorColumnsIndex]?.title,label:"专业",placeholder:"请选择",rules:[{required:!0,message:"请选择专业"}]},on:{click:function(t){e.majorPopupVisible=!0}}}),e._v(" "),t("van-field",{attrs:{readonly:"","is-link":"",value:e.subjectColumns[e.subjectColumnsIndex]?.title,label:"科目",placeholder:"请选择",rules:[{required:!0,message:"请选择科目"}]},on:{click:e.openSubjectPicker}}),e._v(" "),t("van-field",{attrs:{center:"",name:"checkbox"},scopedSlots:e._u([{key:"input",fn:function(){return[t("van-checkbox",{model:{value:e.isChooseParentId,callback:function(t){e.isChooseParentId=t},expression:"isChooseParentId"}},[e._v("是否新增到已有知识点目录下")])]},proxy:!0}])}),e._v(" "),e.isChooseParentId?t("div",{staticStyle:{margin:"16px",border:"1px solid #f5f6f7"}},[e._l(e.knowledgeCatalogColumnsList,(function(o,n){return t("van-field",{key:n,attrs:{center:"",readonly:"","is-link":"",value:o.columns[o.columnsIndex]?.title,label:"父级"+(n+1),placeholder:"请选择",rules:e.isChooseParentId?[{required:!0,message:"请选择父级"+(n+1)}]:null},on:{click:e.openKnowledgeCatalogPicker}})})),e._v(" "),t("div",{staticStyle:{display:"flex","flex-direction":"row-reverse",margin:"16px"}},[t("van-button",{staticStyle:{"margin-left":"16px"},attrs:{size:"small",type:"info"},on:{click:function(t){return t.preventDefault(),e.nextKnowledgeCatalogColumnsIndex.apply(null,arguments)}}},[e._v("选择下一级")]),e._v(" "),t("van-button",{attrs:{size:"small",type:"warning"},on:{click:function(t){return t.preventDefault(),e.prevKnowledgeCatalogColumnsIndex.apply(null,arguments)}}},[e._v("回到上一级")])],1)],2):e._e(),e._v(" "),t("van-field",{attrs:{center:"",readonly:!(-1!==e.subjectColumnsIndex||-1!==e.knowledgeCatalogColumnsListIndex&&-1!==e.knowledgeCatalogColumnsList[e.knowledgeCatalogColumnsListIndex].columnsIndex),name:"新知识点目录",label:"新知识点目录",placeholder:"请填写",rules:[{required:!0,message:"请填写新知识点目录"}]},on:{click:e.clickNewKnowledgeCatalogTitleInput},model:{value:e.formData.title,callback:function(t){e.$set(e.formData,"title",t)},expression:"formData.title"}}),e._v(" "),t("div",{staticStyle:{margin:"16px"}},[t("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit"}},[e._v("提交")])],1)],1),e._v(" "),t("van-popup",{attrs:{position:"bottom"},model:{value:e.majorPopupVisible,callback:function(t){e.majorPopupVisible=t},expression:"majorPopupVisible"}},[t("van-picker",{attrs:{title:"选择专业","show-toolbar":"","value-key":"title",columns:e.majorColumns},on:{confirm:e.onMajorConfirm,cancel:function(t){e.majorPopupVisible=!1}}})],1),e._v(" "),t("van-popup",{attrs:{position:"bottom"},model:{value:e.subjectPopupVisible,callback:function(t){e.subjectPopupVisible=t},expression:"subjectPopupVisible"}},[t("van-picker",{attrs:{title:"选择科目","show-toolbar":"","value-key":"title",columns:e.subjectColumns},on:{confirm:e.onSubjectConfirm,cancel:function(t){e.subjectPopupVisible=!1}}})],1),e._v(" "),t("van-popup",{attrs:{position:"bottom"},model:{value:e.knowledgeCatalogPopupVisible,callback:function(t){e.knowledgeCatalogPopupVisible=t},expression:"knowledgeCatalogPopupVisible"}},[t("van-picker",{attrs:{title:"选择父级知识点目录","show-toolbar":"","value-key":"title",columns:e.knowledgeCatalogColumnsList[e.knowledgeCatalogColumnsListIndex]?.columns},on:{confirm:e.onKnowledgeCatalogConfirm,cancel:function(t){e.knowledgeCatalogPopupVisible=!1}}})],1)],1)};n._withStripped=!0;const l={data:()=>({formData:{subject_id:"",parent_id:"",sort:1,title:""},majorPopupVisible:!1,majorColumns:[],majorColumnsIndex:-1,subjectPopupVisible:!1,subjectColumns:[],subjectColumnsIndex:-1,isChooseParentId:!1,knowledgeCatalogPopupVisible:!1,knowledgeCatalogColumnsList:[],knowledgeCatalogColumnsListIndex:-1}),watch:{isChooseParentId(){this.knowledgeCatalogColumnsListIndex=-1,this.knowledgeCatalogColumnsList=[],this.isChooseParentId&&(-1!==this.subjectColumnsIndex?this.subjectColumns[this.subjectColumnsIndex]?.subject_id:(this.$notify({type:"warning",message:"请先选择一个科目"}),this.isChooseParentId=!1))}},computed:{subjectId(){return this.$route.query.id}},mounted(){},methods:{submitForm(){let e=this.knowledgeCatalogColumnsList[this.knowledgeCatalogColumnsListIndex],t=e?.columns[e.columnsIndex].knowledge_catalog_id;t?(this.formData.parent_id=t,this.formData.subject_id=""):(this.formData.subject_id=this.subjectColumns[this.subjectColumnsIndex].subject_id,this.formData.parent_id="")},onMajorConfirm(e,t){this.majorColumnsIndex=t,this.majorPopupVisible=!1},openSubjectPicker(){this.subjectColumns.length>0?this.subjectPopupVisible=!0:this.$notify({type:"warning",message:"该专业下没有科目，请新增科目或者更换专业"})},onSubjectConfirm(e,t){this.subjectColumnsIndex=t,this.subjectPopupVisible=!1},openKnowledgeCatalogPicker(){this.knowledgeCatalogPopupVisible=!0},onKnowledgeCatalogConfirm(e,t){let o=this.knowledgeCatalogColumnsList,n=this.knowledgeCatalogColumnsListIndex,l=o[n];l.columnsIndex=t,o[n]=l,this.knowledgeCatalogColumnsList=o,this.knowledgeCatalogPopupVisible=!1},nextKnowledgeCatalogColumnsIndex(){let e=this.knowledgeCatalogColumnsList[this.knowledgeCatalogColumnsListIndex];if(-1===e.columnsIndex)return void this.$notify({type:"warning",message:"请先选择父级"});let t=e.columns[e.columnsIndex].knowledge_catalog_id;getKnowledgeCatalogListByParentId(t).then((e=>{0===e.Count?this.$notify({type:"warning",message:"当前父级知识点目录下没有知识点目录"}):(this.knowledgeCatalogColumnsList.push({columnsIndex:-1,columns:e.Items}),this.knowledgeCatalogColumnsListIndex+=1)}))},prevKnowledgeCatalogColumnsIndex(){this.knowledgeCatalogColumnsListIndex<1?this.$notify({type:"warning",message:"已经是最上一级"}):(this.knowledgeCatalogColumnsListIndex-=1,this.knowledgeCatalogColumnsList.pop())},clickNewKnowledgeCatalogTitleInput(){-1===this.subjectColumnsIndex?(this.$notify({type:"warning",message:"请先选择一个科目"}),this.formData.title=""):(this.isChooseParentId&&-1===this.knowledgeCatalogColumnsListIndex||-1===this.knowledgeCatalogColumnsList[this.knowledgeCatalogColumnsListIndex]?.columnsIndex)&&(this.$notify({type:"warning",message:"请先选择一个父级知识点目录"}),this.formData.title="")}}},s=(0,o(1900).Z)(l,n,[],!1,null,null,null).exports}}]);