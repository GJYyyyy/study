"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[533],{5533:(t,e,i)=>{i.r(e),i.d(e,{default:()=>r});var a=function(){var t=this,e=t._self._c;return e("div",[e("van-tabs",{attrs:{color:"var(--blue)",background:"var(--primary-color)"},on:{change:t.onTabChange},model:{value:t.currentTabIndex,callback:function(e){t.currentTabIndex=e},expression:"currentTabIndex"}},t._l(t.tabs,(function(t,i){return e("van-tab",{key:i,attrs:{title:t.title}})})),1),t._v(" "),e("custom-list",{key:t.currentTab.list.length,attrs:{list:t.currentTab.list,finished:t.currentTab.finished,"child-list-path":t.currentTab.childListPath,"detail-path":t.currentTab.detailPath,"update-path":t.currentTab.updatePath,"collection-key":t.currentTab.collectionKey},on:{delete:t.onDelete,refresh:t.onPullRefresh,load:t.onListLoad,collection:t.onCollection,uncollection:t.onUnCollection}}),t._v(" "),e("custom-search",{on:{search:t.onSearch}})],1)};a._withStripped=!0;var s=i(2996),l=i(3671);const n={components:{"custom-search":l.Ny,"custom-list":l.SP,"custom-tree":l.Uh},data:()=>({currentTabIndex:0,tabs:[{title:"专业",value:"major",listApi:"listMajor",deleteApi:"deleteMajor",childListPath:"/listSubject",updatePath:"/updateMajor",list:[],listParams:{keyword:"",pageSize:20,last:void 0},finished:!1,PRIMARY_KEY:"major_id"},{title:"科目",value:"subject",listApi:"listSubject",deleteApi:"deleteSubject",childListPath:"/listKnowledgeCatalog",updatePath:"/updateSubject",list:[],listParams:{keyword:"",pageSize:20,last:void 0},finished:!1,PRIMARY_KEY:"subject_id"},{title:"知识点目录",value:"knowledge_catalog",listApi:"listKnowledgeCatalog",deleteApi:"deleteTreeKnowledgeCatalog",childListPath:"/listKnowledge",updatePath:"/updateKnowledgeCatalog",list:[],listParams:{keyword:"",pageSize:20,last:void 0},finished:!1,PRIMARY_KEY:"knowledge_catalog_id"},{title:"知识点",value:"knowledge",listApi:"listKnowledge",deleteApi:"deleteKnowledge",detailPath:"/detailKnowledge",updatePath:"/updateKnowledge",collectionKey:"knowledge_collection_id",list:[],listParams:{keyword:"",pageSize:20,last:void 0},finished:!1,PRIMARY_KEY:"knowledge_id"}]}),computed:{currentTab:{get:function(){return this.tabs[this.currentTabIndex]},set:function(t){this.tabs[this.currentTabIndex]=t}}},async mounted(){this.init()},methods:{async getList(){let t=s.Z[this.currentTab.listApi];return await t(this.currentTab.listParams)},async setList(){let t=await this.getList(),{currentTab:e}=this;e.listParams.last=t.last,e.list=this.formatterList(t.list),this.currentTab={...e},t.last||(e.finished=!0)},init(){let{currentTab:t}=this;t.listParams.keyword="",t.listParams.last=void 0,this.currentTab={...t},this.setList()},formatterList(t){return t?.map((t=>t.code?{...t,_title:t.title,_code:t.code,title:t.code?`${t.title}(${t.code})`:t.title,id:t[this.currentTab.PRIMARY_KEY]}:{...t,id:t[this.currentTab.PRIMARY_KEY]}))},onTabChange(){this.init()},onPullRefresh(){let{currentTab:t}=this;t.listParams.last=void 0,t.finished=!1,t.list=[],this.currentTab={...t},this.setList()},onSearch(t){let{currentTab:e}=this;e.listParams.last=void 0,e.finished=!1,e.list=[],e.listParams.keyword=t,this.currentTab={...e},this.setList()},async onListLoad(){let t=await this.getList(),{currentTab:e}=this;e.listParams.last=t.last,e.list=e.list.concat(this.formatterList(t.list)),this.currentTab={...e},t.last||(e.finished=!0)},async onDelete(t){let e=s.Z[this.currentTab.deleteApi];await e([t]),this.$toast.success({message:"删除成功",onClose:()=>this.init()})},async onCollection(t){await s.Z.addKnowledgeCollection({knowledge_id:t}),this.$toast.success("收藏成功"),this.init()},async onUnCollection(t){await s.Z.deleteKnowledgeCollection([t]),this.$toast.success("取消收藏成功"),this.init()}}},r=(0,i(1900).Z)(n,a,[],!1,null,null,null).exports}}]);