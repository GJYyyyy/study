"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[593],{8593:(t,e,a)=>{a.r(e),a.d(e,{default:()=>u});var l=function(){var t=this,e=t._self._c;return e("div",[e("van-form",{on:{submit:t.onSubmit}},[e("van-field",{attrs:{label:"科目",readonly:"",value:t.currentSubjectTitle}}),t._v(" "),e("van-field",{attrs:{label:"父目录",readonly:"",value:t.parent?.title??"无"}}),t._v(" "),e("van-field",{attrs:{name:"目录名",label:"目录名",placeholder:"目录名",rules:[{required:!0,message:"请填写目录名"}]},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}}),t._v(" "),e("div",{staticStyle:{margin:"16px"}},[e("van-button",{attrs:{round:"",block:"",type:"info",size:"small","native-type":"submit"}},[t._v("提交")])],1)],1),t._v(" "),e("div",{staticStyle:{margin:"16px"}},[e("van-button",{attrs:{round:"",block:"",type:"danger",size:"small"},on:{click:t.onDeleteKnowledgeCatalog}},[t._v("删除")])],1)],1)};l._withStripped=!0;var i=a(3308),n=a(1241);const o="knowledge_catalog_id",s="subject_id",r="parent_id",d={data:()=>({formData:{title:"",[r]:"null"},currentSubjectTitle:"",parent:{}}),computed:{[o](){return this.$route.query.id}},async mounted(){let t;(0,n.QP)();try{t=await i.Z.detailKnowledgeCatalog(this[o],{fields:["title","code",s,r]})}catch(t){(0,n.Zk)()}let e,{formData:a}=this;a.title=t.data.title,a.parent_id=t.data.parent_id,this.formData={...a};try{e=await i.Z.detailSubject(t.data[s],{fields:["title","code"]})}catch(t){(0,n.Zk)()}if(this.currentSubjectTitle=e.data.code?`${e.data.title}(${e.data.code})`:e.data.title,t.data.parent_id){let e;try{e=await i.Z.detailKnowledgeCatalog(t.data.parent_id,{fields:["title"]})}catch(t){(0,n.Zk)()}this.parent=e.data}(0,n.Zk)()},methods:{onSubmit(){let t={...this.formData};(0,n.QP)(),i.Z.updateKnowledgeCatalog(this[o],(0,n.mG)(t)).then((()=>{(0,n.Zk)(),this.$toast.success({message:"更新成功",onClose:()=>this.$router.push({path:"/listKnowledgeCatalog",query:{init:1}})})}),(()=>(0,n.Zk)()))},onDeleteKnowledgeCatalog(){this.$dialog.confirm({message:"确认删除"}).then((()=>{(0,n.QP)(),i.Z.deleteTreeKnowledgeCatalog([this[o]]).then((()=>{(0,n.Zk)(),this.$toast.success({message:"删除成功",onClose:()=>this.$router.push({path:"/listKnowledgeCatalog",query:{init:1}})})}),(()=>(0,n.Zk)()))}))}}},u=(0,a(1900).Z)(d,l,[],!1,null,null,null).exports}}]);