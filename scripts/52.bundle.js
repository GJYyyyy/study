(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[52],{655:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});var o=n(6738),a=n.n(o),l=n(7705),s=n.n(l)()(a());s.push([t.id,"\n.update-knowledge .btn-set[data-v-d887c3c6] {\n    margin: 16px;\n}\n.update-knowledge .btn-set[data-v-d887c3c6] .van-button {\n    width: 44%;\n}\n",""]);const i=s},7052:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>u});var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"update-knowledge"},[e("van-form",{on:{submit:t.onSubmit}},[e("van-field",{attrs:{label:"知识点目录",readonly:"",value:t.currentKnowledgeCatalogTitle}}),t._v(" "),e("van-field",{attrs:{name:"标题",label:"标题",placeholder:"标题",rules:[{required:!0,message:"请填写标题"}]},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}}),t._v(" "),e("van-field",{attrs:{label:"内容",readonly:""}}),t._v(" "),t.defaultContent?e("custome-markdown-editor",{attrs:{value:t.defaultContent},on:{change:t.onMarkdownChange,save:t.onMarkdownSave}}):t._e(),t._v(" "),e("div",{staticClass:"row-between btn-set"},[e("van-button",{attrs:{round:"",type:"danger",size:"small","native-type":"button"},on:{click:t.onDeleteKnowledge}},[t._v("删除")]),t._v(" "),e("van-button",{attrs:{round:"",color:t.collectionColor,size:"small","native-type":"button"},on:{click:t.onCollection}},[t._v(t._s(t.collectionText))])],1),t._v(" "),e("div",{staticStyle:{margin:"16px"}},[e("van-button",{attrs:{round:"",block:"",type:"info",size:"small","native-type":"submit"}},[t._v("提交")])],1)],1)],1)};o._withStripped=!0;var a=n(3308),l=n(1241),s=n(7632);const i="knowledge_id",d="knowledge_catalog_id",c="knowledge_collection_id",r={components:{"custome-markdown-editor":s.NW},data:()=>({formData:{title:"",content:""},defaultContent:"",currentKnowledgeCatalogTitle:"",[c]:void 0}),computed:{[i](){return this.$route.query.id},collectionText(){return this[c]?"已收藏":"收藏"},collectionColor(){return this[c]?"var(--green)":"var(--gray-3)"}},async mounted(){this.init()},methods:{async init(){let t;(0,l.QP)();try{t=await a.Z.detailKnowledge(this.knowledge_id,{fields:["title","content",d]})}catch(t){(0,l.Zk)()}let e,n=decodeURIComponent(t.data.content)||" ",{formData:o}=this;o.title=t.data.title,o.content=n,this.formData={...o},this.defaultContent=n,console.debug(t),this[c]=t.data[c];try{e=await a.Z.detailKnowledgeCatalog(t.data[d],{fields:["title"]})}catch(t){(0,l.Zk)()}this.currentKnowledgeCatalogTitle=e.data.title,(0,l.Zk)()},onSubmit(){let t={...this.formData};t.content=encodeURIComponent(t.content),(0,l.QP)(),a.Z.updateKnowledge(this.knowledge_id,(0,l.mG)(t)).then((()=>{(0,l.Zk)(),this.$toast.success({message:"更新成功",onClose:()=>this.$router.back()})}),(()=>(0,l.Zk)()))},onDeleteKnowledge(){this.$dialog.confirm({message:"确认删除"}).then((()=>{(0,l.QP)(),a.Z.deleteKnowledge([this.knowledge_id]).then((()=>{(0,l.Zk)(),this.$toast.success({message:"删除成功",onClose:()=>this.$router.back()})}),(()=>(0,l.Zk)()))}))},onMarkdownChange(t){let{formData:e}=this;e.content=t},onMarkdownSave(t){let e={...this.formData};e.content=encodeURIComponent(t),(0,l.QP)(),a.Z.updateKnowledge(this.knowledge_id,(0,l.mG)(e)).then((()=>{(0,l.Zk)(),this.$toast.success({message:"保存成功"})}),(()=>(0,l.Zk)()))},async onCollection(){(0,l.QP)(),this[c]?(await a.Z.deleteKnowledgeCollection([this[c]]),this.$toast.success("取消收藏成功"),this.init()):(await a.Z.addKnowledgeCollection({[i]:this.knowledge_id}),this.$toast.success("收藏成功"),this.init()),(0,l.Zk)()}}};n(8121);const u=(0,n(1900).Z)(r,o,[],!1,null,"d887c3c6",null).exports},8121:(t,e,n)=>{var o=n(655);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.id,o,""]]),o.locals&&(t.exports=o.locals);var a=(0,n(4023).Z)("486440f5",o,!1,{});o.locals||t.hot.accept(655,(function(){var e=n(655);e.__esModule&&(e=e.default),"string"==typeof e&&(e=[[t.id,e,""]]),a(e)})),t.hot.dispose((function(){a()}))}}]);